{% extends "base.html" %}
﻿﻿{% load oifilters %}
{% load i18n %}
{% block title %}{{object.title|default:_("Project")}}{% endblock %}
{% block spacetitle %}{{object.master.title}}{% endblock %}
{% block tabs %}
<div class="{% ifequal view "description" %}selectedtab{% else %}tab{% endifequal %}">
    <a href="description"><img class="tabicon" src="/img/icons/spec.png"/> description</a>
</div>
<div class="{% ifequal view "budget" %}selectedtab{% else %}tab{% endifequal %}">
    <a href="budget"><img class="tabicon" src="/img/icons/budget.png"/> budget</a>
</div>
<div class="{% ifequal view "team" %}selectedtab{% else %}tab{% endifequal %}">
    <a href="team"><img class="tabicon" src="/img/icons/team.png"/> team</a>
</div>
<div class="{% ifequal view "planning" %}selectedtab{% else %}tab{% endifequal %}">
    <a href="planning"><img class="tabicon" src="/img/icons/planning.png"/> planning</a>
</div>
{% endblock %}
{% block nav %}
<div id="projecttree"></div>
{%comment%}
<div class="navtitle" onmouseover="gantt.barids[{{object.master.id}}].bardiv.style.border='solid 5px red'" onmouseout="gantt.barids[{{object.master.id}}].bardiv.style.border='none'">
    <img id="treebtn_{{object.master.id}}" src="/img/icons/treebtn{{object.master.state}}-closed.png" onclick="listTasks({{object.master.id}})"/><a href="/project/get/{{object.master.id}}">{{object.master.title}}</a>
    <div><form id="newtask_{{object.master.id}}"></form></div>
</div>
<div class="tasklist" id="tasks_{{object.master.id}}"></div>
{% endcomment %}
{% endblock %}
{% block content %}
{% if object|can_read:user %}
{% with object as project %}
{% with "projects/project_"|add:view|add:".html" as template_name %}
{% include template_name %}
{% endwith %}
{% endwith %}
<script>
    username = '{{user.username}}';
    viewname = '{{view}}';
    oiTree = new OITree("projecttree");
    oiTree.gantt = gantt;
    setTaskName(oiTree.setRoot({{object.master.id}}, {{object.master.state}}, 0), {{object.master.id}}, "{{object.master.title}}", "{{view}}");
    {% for ancestor in object.get_path %}
    oiTree.nodes[{{ancestor.id}}].expand();
    {% endfor %}
    setActiveTask({{object.id}});
    gantt.redraw();
</script>
{% else %}
{% trans "Forbidden" %}
{% endif %}
{% endblock %}
