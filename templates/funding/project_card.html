{% load i18n %}
{% load oifilters %}
<div class="prjcard">
    <a href="/funding/{{project.id}}"><div class="prjtitle funding_space">{{project.title}}</div></a>
    <div class="prjcardauthor">
        {% trans "Project created by" %}
        <a href="/user/profile/{{project.author.username}}">{{project.author.get_profile}}</a>
        </div>
    <div class="cleared"></div>
    {% with project.spec_set.all|dictsort:"order" as specs%}
    {% with specs.0 as spec %}<a href="/funding/{{project.id}}"><div class="cardspec">{% include 'funding/spec/minispec.html' %}</div></a>{% endwith %}
    {% with specs.1 as spec %}<div class="cardspec" style="height: 8.5em;overflow:hidden">{% include 'funding/spec/minispec.html' %}</div>{% endwith %}
    {% endwith %}
    {% with project.descendants|filter_read:user as descendants %}
    <div class="fundingprogress">
        <div class="progressbar dotted">
            <span id="progressbar_{{object.id}}" class="progress" style="width:{% widthratio descendants.allbid_sum|add:project.bid_sum project.get_selfbudget|default:descendants.allbudget 100 %}%;"></span>
            <span id="progresslabel_{{object.id}}" class="progresstitle" >{% widthratio descendants.allbid_sum|add:project.bid_sum project.get_selfbudget|default:descendants.allbudget 100 %} %</span>
        </div>
        <div class="cleared"></div>
        {{descendants.allbid_sum|add:project.bid_sum|floatformat:"-2"}} € {% trans "funded out of" %}
        {{project.get_selfbudget|default:descendants.allbudget|floatformat:"-2"}} €
    </div>
    {% endwith %}
</div>

